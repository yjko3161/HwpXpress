# HwpXpress (HWP to HWPX Converter)

윈도우 환경에서 한글(HWP) 문서를 개방형 포맷인 **HWPX (XML 기반)**로 일괄 변환해주는 도구입니다.
GUI를 통해 폴더 단위의 일괄 변환을 지원하며, 변환 결과에 대한 검증 로직이 포함되어 있습니다.

## ✨ 주요 기능
- **일괄 변환**: 폴더 내의 모든 `.hwp` 파일을 재귀적으로 탐색하여 `.hwpx`로 변환
- **무결성 검증**: 변환된 파일이 단순 확장자 변경이 아닌, 실제 **ZIP/XML 포맷(HWPX)**인지 검사 후 필요 시 재시도 (`KB_HWPX` 등)
- **GUI 지원**: 파일/폴더 선택 및 실시간 로그 확인 가능
- **백그라운드 처리**: 한글 창을 숨겨서 변환 작업 수행

## 📋 사전 요구사항 (Prerequisites)
이 프로그램은 **한글(Hancom Office)** 오토메이션 API를 사용하므로, 한글이 설치된 Windows 환경에서만 작동합니다.
- **OS**: Windows 10/11
- **Software**: 한컴오피스 한글 2010 이상 (권장: 2018 이상)
- **Python**: 3.10 이상

## 🚀 설치 및 실행 (Installation & Usage)

### 1. 환경 설정
프로젝트 폴더에서 `setup_env.bat`를 실행하면 가상 환경이 자동으로 생성되고 필요한 라이브러리가 설치됩니다.
```cmd
setup_env.bat
```

### 2. 프로그램 실행
`run.bat` 파일을 실행하면 가상 환경을 활성화하고 프로그램을 시작합니다.
```cmd
run.bat
```
*(또는 `.venv` 활성화 후 `python main.py` 실행)*

### 3. 사용 방법
1. **Target Path**: `Browse File`(파일 하나) 또는 `Browse Folder`(폴더 전체) 선택
2. **Start Conversion**: 변환 시작
3. 로그 창에서 `Conversion successful` 메시지 확인

## 🌐 변환 결과 확인 (Web Verification)
HWPX는 웹 친화적인 포맷입니다. 변환된 파일이 정상인지 확인하려면:
1. **웨일 브라우저**: `.hwpx` 파일을 네이버 웨일 브라우저로 드래그하면 바로 열립니다.
2. **한컴독스**: [한컴독스](https://www.hancomdocs.com/)에 업로드하여 확인 가능합니다.
3. **구조 확인**: 파일 확장자를 `.zip`으로 변경 후 압축을 풀었을 때, 내부에 XML 파일들이 존재하면 정상입니다.

## ⚠️ 주의사항 및 트러블슈팅
- **보안 모듈**: 처음 실행 시 한글의 "외부 스크립트 실행 허용" 팝업이 뜰 수 있습니다. **[접근 허용]** 또는 **[모두 허용]**을 선택해주세요.
- **백그라운드 실행**: 변환 중에는 한글 창이 숨겨진 상태로 실행됩니다. 오류로 강제 종료될 경우 작업 관리자에서 `Hwp.exe` 프로세스를 수동으로 종료해야 할 수도 있습니다.
- **관리자 권한**: `win32com` 모듈 등록 문제 발생 시, 관리자 권한으로 CMD를 열어 실행해보세요.

## 🛠️ 기술 스택 (Tech Stack)
- **Language**: Python 3.x
- **GUI**: Tkinter
- **Automation**: `pyhwpx` (checking `win32com` wrapper)
